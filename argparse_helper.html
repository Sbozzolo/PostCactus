

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Building command-line scripts &#8212; PostCactus 3.0.0a10 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="List of features implemented in PostCactus" href="features.html" />
    <link rel="prev" title="Visualizing data" href="visualize.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="features.html" title="List of features implemented in PostCactus"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="visualize.html" title="Visualizing data"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">PostCactus 3.0.0a10 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Building command-line scripts</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="building-command-line-scripts">
<h1>Building command-line scripts<a class="headerlink" href="#building-command-line-scripts" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">PostCactus</span></code> is a library and it is designed to assist you in performing your
analyses. Hence, <code class="docutils literal notranslate"><span class="pre">PostCactus</span></code> supports multiple workflows. A possible choice
consists in writing command-line executables to perform specific tasks. For
example, it is useful to have a script <code class="docutils literal notranslate"><span class="pre">plot_grid.py</span></code> that takes a simulation
folder and a variable name and plots a 2D snapshot of such variable. The module
<a class="reference internal" href="argparse_helper_ref.html#module-postcactus.argparse_helper" title="postcactus.argparse_helper"><code class="xref py py-mod docutils literal notranslate"><span class="pre">argparse_helper</span></code></a> contains functions to make writing such scripts
easier (<span class="xref std std-ref">unitconv_ref:Reference on postcactus.argparse_helper</span>).</p>
<div class="section" id="argparse-and-argparse-helper">
<h2>Argparse and argparse_helper<a class="headerlink" href="#argparse-and-argparse-helper" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">argparse</span></code> is a built-in module in Python used to read information from the
command line. <a class="reference internal" href="argparse_helper_ref.html#module-postcactus.argparse_helper" title="postcactus.argparse_helper"><code class="xref py py-mod docutils literal notranslate"><span class="pre">argparse_helper</span></code></a> provides functions that automatically
populate <code class="docutils literal notranslate"><span class="pre">argparse</span></code> with common options and reasonable defaults. The minimum
working example is simply</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">postcactus</span> <span class="kn">import</span> <span class="n">argparse_helper</span> <span class="k">as</span> <span class="n">pah</span>

<span class="n">desc</span> <span class="o">=</span> <span class="s2">&quot;This is an example&quot;</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">pah</span><span class="o">.</span><span class="n">init_argparse</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">pah</span><span class="o">.</span><span class="n">get_args</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
</pre></div>
</div>
<p>This will populate the options <code class="docutils literal notranslate"><span class="pre">configfile</span></code>, <code class="docutils literal notranslate"><span class="pre">verbose</span></code>, <code class="docutils literal notranslate"><span class="pre">datadir</span></code>, and
<code class="docutils literal notranslate"><span class="pre">outdir</span></code>, which can be accessed with <code class="docutils literal notranslate"><span class="pre">args.varname</span></code> (e.g.,
<code class="docutils literal notranslate"><span class="pre">args.verbose</span></code>), or with <code class="docutils literal notranslate"><span class="pre">args.fields['varname']</span></code>. <code class="docutils literal notranslate"><span class="pre">PostCactus</span></code> supports
being configured with configfiles, which can be useful to control scripts with
many options. The method <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_args()</span></code> takes the parser object and
process the command-line data.</p>
<p><code class="docutils literal notranslate"><span class="pre">parser</span></code> can be extended with more common options. For example, if you are
working with grid data, you will likely will want to specify grid extents. To
add common grid options, use the method <code class="xref py py-meth docutils literal notranslate"><span class="pre">add_grid_to_parser()</span></code>, which
adds arguments like <code class="docutils literal notranslate"><span class="pre">origin</span></code>, <code class="docutils literal notranslate"><span class="pre">corner</span></code>, and <code class="docutils literal notranslate"><span class="pre">resolution</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">postcactus</span> <span class="kn">import</span> <span class="n">argparse_helper</span> <span class="k">as</span> <span class="n">pah</span>

<span class="n">desc</span> <span class="o">=</span> <span class="s2">&quot;This is an example&quot;</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">pah</span><span class="o">.</span><span class="n">init_argparse</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
<span class="n">pah</span><span class="o">.</span><span class="n">add_grid_to_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">pah</span><span class="o">.</span><span class="n">get_args</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
</pre></div>
</div>
<p>Often, the default arguments are not enough and you want to add your own. This
can be achieved with the method <code class="docutils literal notranslate"><span class="pre">add_argument</span></code>, as in the following example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">postcactus</span> <span class="kn">import</span> <span class="n">argparse_helper</span> <span class="k">as</span> <span class="n">pah</span>

<span class="n">desc</span> <span class="o">=</span> <span class="s2">&quot;This is an example&quot;</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">pah</span><span class="o">.</span><span class="n">init_argparse</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
     <span class="s2">&quot;--variable&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Variable to plot&quot;</span>
<span class="p">)</span>
<span class="n">pah</span><span class="o">.</span><span class="n">add_grid_to_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">pah</span><span class="o">.</span><span class="n">get_args</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
</pre></div>
</div>
<p>Most of the scripts in <code class="docutils literal notranslate"><span class="pre">example_bins</span></code> are built for this kind of workflow, so
you can use them as examples (or you can directly use them).</p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Building command-line scripts</a><ul>
<li><a class="reference internal" href="#argparse-and-argparse-helper">Argparse and argparse_helper</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="visualize.html"
                        title="previous chapter">Visualizing data</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="features.html"
                        title="next chapter">List of features implemented in PostCactus</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="features.html" title="List of features implemented in PostCactus"
             >next</a> |</li>
        <li class="right" >
          <a href="visualize.html" title="Visualizing data"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">PostCactus 3.0.0a10 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Building command-line scripts</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Gabriele Bozzola and Wolfgang Kastaun.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.3.1.
    </div>
  </body>
</html>